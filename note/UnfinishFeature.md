# 待完成的功能

## PageFactory

1. 实现修改fontSize的情况下的页面显示功能  (完成，会造成上翻页和下翻页的不一致问题)
2. 更换夜间模式的图片,还有缓存的图片  (完成)
3. 实现缓存功能                    (暂时，不提供缓存功能)
4. 当缓存下一章失败的时候的错误提示功能  (完成)
5. 顶部的社区、简介的跳转 (社区暂时未完成)

6. 添加更多设置(提供 完全沉浸式，屏幕关闭时间，支持音量键翻页，休息提醒) (完成部分)
7. 支持其他多种格式(epub、pdf)
8. 解析多种编码(目前只支持utf-8编码的文件)
9. 支持上下翻页 (内部嵌套RecyclerView 还是使用多个Bitmap进行绘制)
10. 支持侧滑栏有个ScrollBar (完成)

## BookShelfFragment

1. 删除收藏的书籍  (完成)

正在下载的同时删除，会报错。

强制同时删除文件。(完成)
2. 批量删除的功能
3. 置顶的功能

## 主界面菜单上的功能

1. 登陆功能
2. 扫描本地书籍的功能  (完成)
3. Wifi传书
4. 夜间模式 (不提供)
5. 设置(放什么功能还不知道..之后想想)
6. 搜索功能的实现  (完成)

## 评论区

评论区未出现数据的时候的页面显示问题

## 评论区的详情页面

点击书名，进行搜索的功能

## 排行榜内的BookListActivity

1. 实现Toolbar的滑动隐藏

## BookSortActivity

修改横向滑动栏的样式

## BookDetailActivity

1. 需要添加书籍的tag并通过tag查找类似的书籍功能
2. 热门书评页的跳转
3. 社区页面的跳转
4. 推荐书单的跳转

## DownloadService

当页面关闭的时候，Service不会退出。之后需要改成如果没有任务情况下在页面消失的时候退出。

## 当Activity被强杀后

这部分的逻辑没有写。

## 阶段性计划

### 第二阶段计划

仿照布卡漫画的样式进行重构

### 第三阶段

加入看漫画的功能:参考[Cimoc](https://github.com/Arachnid-27/Cimoc)

# 待优化的功能

## 文章缓存问题

首先介绍下该项目实现缓存的基本原理是
1. 当书本进行缓存的时候首先判断是否在加载队列中，如果存在则输出已在队列中。
2. 如果该书已完成则会将最后完成的章节存储到数据库，当书籍存在更新并且再次下载时候，会从上此已加载完成的地方作为起始点
3. 书本的缓存api是提供一章一章的地址，而非整本小说的地址。对每章返回的数据在sd中创建对应章节的file文件。 ==>这里就存在大量可优化的地方。
   * 由于存在每章数据较大的可能性，所以最好的方法是获取http的inputstream，然后创建File文件，再获取file的outputStream
     互相连接，进行对数据的缓存，不需要经过内存。由于我使用的是retrofit，retrofit会自动获取OkHttp中的body管道中的数据，存储到内存中。
     ，所以我必须从内存中获取http返回的数据，再存储到file中
   * 每次接受一个章节就创建一个file的开销太大了，一般的情况应该是将每个章节的数据存储到一个文件中。

## 文章加载显示问题

加载过程的描述:
1. 通过BufferReader从File中提取所有file数据到内存中，并使用WeakReference保存。

   * 可优化的地方:BufferReader没有做编码判断。 还有一次读取file文件下的所有内容到内存中，放到String里 ==> 这里使用Channel可能是更优化的选择

2. 显示page的原理是：通过查询String的"\n"获取一段数据，之后对段落进行拆分换行，直到写满一页位置。并记录终止点。
但是这种方式遇到返回上一章的末尾，修改字体样式，拖动百分比翻页这些功能，这种方法就无法满足。能够想到最好的方式是从头遍历
找到终止点，但是这种方法的开销有点大，所以需要思考有没有更好的方法。

## 章节加载错误问题

逻辑实现比较丑陋。当下一章正在加载或者加载错误的时候，无法加载到下一章。并提示正在加载中，如果下一章无法获取数据的情况
下，还是会显示正在加载的问题。 之后的实现是允许用户翻到下一章，并且实现正在加载和加载错误的显示提示。

想法，将章节转换成一个Page，这样就不会造成问题了。分为状态绘制和内容绘制两部分。

# 待编写的具体实现的教程

## 自定义框架

1. BaseAdapter的使用(ViewHolder的解耦合，自由加入Header和footer,提供刷新和加载的实现流程)

2. 理解原作者的MVP双向绑定及Activity与Presenter的实现。

## 外部依赖

1. RxJava的简单原理，及其运算符在项目中的运用

2. GreenDao的使用(如何建立关系存储和读取)

## 自定义控件

1. SelectorView的实现(选择器)

2. RatingBar的简单实现

3. GridAdapter的实现

4. PageView的实现

## 复杂的功能实现

1. 断点续传的实现

2. 小说阅读器的实现