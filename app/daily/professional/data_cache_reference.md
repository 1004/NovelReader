# 数据缓存操作参考

1. 当首次刷新的时候首先中数据库中获取数据，然后再从网络中获取数据。
2. 如果从网络中获取数据失败，那么加载的时候就直接从数据库中获取数据。直到启用刷新重新从网络中获取数据为止
3. 当网络获取成功的时候，将获取到的数据首先存储到数据库中，再存储到缓存中。
4. 之后数据就首先从缓存中获取如果缓存不存在再从数据库中获取，最后从网络中获取。
5. 给数据设定死亡时间，当超过时间的时候，不再从缓存中获取数据。直接从网络中加载。

就是设定缓存时间这个东西是否合理。。。人家想要实时刷新怎么办。所以说在后台中还要有缓存时间的设定吗，或者说没有必要设置缓存。
那我们来想一想，什么情况下需要缓存。比如说书的列表别人刷新就是为了获取新数据的，那么有必要设定缓存吗?下拉加载是获取旧数据的所以有必要缓存一下。
还有就是详情页面，一般情况下数据是不改变的，所以有必要采取缓存。所以说是否进行缓存是根据功能决定的。那么这个功能是根据页面决定的，能不能写出这样的一个框架呢？
之后还有缓存的清除(LruCache)。

## 制作

第一步:首先从数据库和网络中共同获取数据。然后加载显示。如果数据加载成功则后面一直使用。
这里的问题是代码冗余太多，如何减少代码冗余。还有就是数据加载的逻辑和网络加载的逻辑不完全相同的问题。

逻辑:
1. 从数据库获取，并从网络加载，重新写入数据库。
2. (从缓存中获取，从数据库中获取缓存)，从网络中获取，(写入到数据库中,再写入到缓存中)。
3. RxJava的方法太多了，封装一下。

## 详情页面的缓存要求