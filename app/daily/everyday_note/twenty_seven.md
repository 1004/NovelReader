# 任务

1. 完成书籍的删除

2. 完成本地书籍导入的功能。

## 书籍的删除

功能:

1. 收藏页面点击删除。
2. 删除会将下载列表中所有的记录和本地文件全部删除。
3. 当某个任务正在加载的时候无法删除，需要暂停任务，才能够删除。

首先说明，这种方式可能不太友好，关于其他方式的设计，需要等到以后再说。


基础原理:发送删除请求到任务列表中，如果任务正在等待或者加载，那么就返回说明需要先暂停任务，才能进行删除。
如果任务没有被加载，则删除存储在List中的人物，然后进行回调。回调之后，首先从Adapter中删除书籍。然后
从数据库中删除任务，删除目录，删除文件。

这里的交互都是通过RxBus实现的，感觉方式上有点问题，需要改进。(感觉实现方式太丑陋了，正确的方式应该是创建Binder)
(明天使用IBinder重构一下，马旦，脑子短路了，现在才想起来。。)

## 书籍展示系统的制作

### 智能导入书籍页面的制作。

1. 文件夹下txt文件的获取。(完成)
2. 制作Adapter (未完成) ==> Adapter为通用Adapter，传入参数为File
3. 全选点击的问题 ()

### 手机目录的制作

1. 文件显示  (完成)
2. 文件回退功能 (正在制作)

还差:

1. 在FileCategory中，当没有file的时候，全选无法点击这个功能。
2. 删除功能 (之后做)
3. 添加书籍功能需要在小说重构之后做完

# 后面的计划

重构小说加载页面，支持页码，字节大小问题，弱网环境下判断加载的问题(弱网环境下最好加载取消上次加载的功能)

一定重新思考一下需要加入那些功能，然后把主干先做出来，然后再制作其他的功能。

思考重构:

1. 从文件中获取数据的方式。(思考遗漏的东西: 文件过大的处理，文件格式的处理)
2. 获取数据进行页码转换并且缓存的方式
3. 将数据转换成页码之后设计的功能
4. 如何将状态变化加入到绘制中
5. 如何保证不过度加载(比如下两章还没有加载完成，又加载了重复章节的问题)
6. 弱网环境下，可能造成未openChapter就进行保存导致崩溃的情况
7. 如何导入大文件的本地书籍
8. 如何加入其他格式

回复:

总流程的思考:

总体假设:不考虑本地文件的问题，假设单章数据不会过载。那么该如何设计。

读取章节部分:首先假设章节已存在本地中。

流程:首先指定获取哪个文本，确定当前每页的行数目。然后获取到文件的管道，之后考虑如何加载成一页，一页需要保证缩进和换行
符占用行的问题。


从文件中获取数据

需要思考的问题:
1. 文件过大的问题  (本地加载会造成的问题)
2. 文件编码的问题  (本地加载会造成的问题)
3. 使用哪种方式获取的问题
4. 如何进行缓存到内存中。

